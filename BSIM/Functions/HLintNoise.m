function InternalNoise = HLintNoise(Audiogram,fc)
% calculate internal noise accodring to thresholds in dB SPL Therefore a
% dBHL to dBSPL conversion is needed to

freq = Audiogram(:,1);
dBHL = Audiogram(:,2:3);
% Taken from BSIM2010
ANSI = [20,62.41;...
        25,52.92;...
        32,43.91;...
        40,35.47;...
        50,28.41;...
        63,21.71;...
        80,15.47;...
        100,10.20;...
        125,5.48;...
        160,0.87;...
        200,-2.96;...
        250,-6.44;...
        315,-9.69;...
        400,-12.62;...
        500,-15.16;...
        630,-17.27;...
        800,-18.66;...
        1000,-19.03;...
        1250,-19.13;...
        1600,-21.46;...
        2000,-25.01;...
        2500,-28.89;...
        3150,-31.92;...
        4000,-32.70;...
        5000,-30.02;...
        6300,-22.98;...
        8000,-15.99;...
        10000,-15.63;...
        12500,-15.48];
for kk=1:length(fc)  
    fc_Hz = fc(kk);
    fc_Hz(fc_Hz < max(min(freq),min(ANSI(:,1)))) = max([fc_Hz(:); min(freq); min(ANSI(:,1))]);
    fc_Hz(fc_Hz > min(max(freq),max(ANSI(:,1)))) = min([fc_Hz(:); max(freq); max(ANSI(:,1))]);
    ERBN = 24.7.*(4.37.*(fc_Hz./1000)+1) ;
    ERB = [ERBN ERBN];
    %% calculate internal noise with NH hearing noise level or HI noise
    %% level
    InternalNoise(kk,1:2) = ERB.*10.^((interp1(freq,dBHL(:,[1 2]),fc_Hz,'linear','extrap')...
        +interp1(ANSI(:,1),ANSI(:,[2 2]),fc_Hz,'linear','extrap'))/10);
end
  %% end of file
    
    
    
    
    
